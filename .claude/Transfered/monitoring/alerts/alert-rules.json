{
  "groups": [
    {
      "name": "ai-orchestrator-critical",
      "interval": "30s",
      "rules": [
        {
          "alert": "ServiceDown",
          "expr": "up{job='ai-orchestrator'} == 0",
          "for": "1m",
          "labels": {"severity": "critical", "component": "service"},
          "annotations": {
            "summary": "AI Orchestrator service is down",
            "description": "Service {{ $labels.instance }} is down for more than 1 minute"
          }
        },
        {
          "alert": "HighErrorRate",
          "expr": "rate(errors_total[5m]) > 10",
          "for": "5m",
          "labels": {"severity": "critical", "component": "application"},
          "annotations": {
            "summary": "High error rate detected",
            "description": "Error rate is {{ $value }} errors/second"
          }
        },
        {
          "alert": "DatabaseConnectionPoolExhausted",
          "expr": "database_connections_active / database_connections_max > 0.9",
          "for": "2m",
          "labels": {"severity": "critical", "component": "database"},
          "annotations": {
            "summary": "Database connection pool nearly exhausted",
            "description": "{{ $value }}% of database connections in use"
          }
        },
        {
          "alert": "MemoryLeakSuspected",
          "expr": "rate(process_resident_memory_bytes[15m]) > 10485760",
          "for": "15m",
          "labels": {"severity": "critical", "component": "memory"},
          "annotations": {
            "summary": "Possible memory leak detected",
            "description": "Memory growing at {{ $value }} bytes/second"
          }
        }
      ]
    },
    {
      "name": "ai-orchestrator-warnings",
      "interval": "1m",
      "rules": [
        {
          "alert": "HighLatency",
          "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 1",
          "for": "5m",
          "labels": {"severity": "warning", "component": "performance"},
          "annotations": {
            "summary": "High API latency detected",
            "description": "P95 latency is {{ $value }}s"
          }
        },
        {
          "alert": "LowCacheHitRate",
          "expr": "(cache_hits / (cache_hits + cache_misses)) < 0.8",
          "for": "10m",
          "labels": {"severity": "warning", "component": "cache"},
          "annotations": {
            "summary": "Low cache hit rate",
            "description": "Cache hit rate is {{ $value }}%"
          }
        },
        {
          "alert": "HighQueueDepth",
          "expr": "task_queue_size > 1000",
          "for": "5m",
          "labels": {"severity": "warning", "component": "queue"},
          "annotations": {
            "summary": "Task queue depth is high",
            "description": "{{ $value }} tasks waiting in queue"
          }
        },
        {
          "alert": "AgentFailureRate",
          "expr": "rate(agent_failures_total[10m]) > 1",
          "for": "10m",
          "labels": {"severity": "warning", "component": "agents"},
          "annotations": {
            "summary": "High agent failure rate",
            "description": "{{ $value }} agent failures per second"
          }
        },
        {
          "alert": "DiskSpaceWarning",
          "expr": "(disk_used_bytes / disk_total_bytes) > 0.8",
          "for": "5m",
          "labels": {"severity": "warning", "component": "storage"},
          "annotations": {
            "summary": "Disk space running low",
            "description": "{{ $value }}% disk space used"
          }
        }
      ]
    },
    {
      "name": "ai-orchestrator-security",
      "interval": "30s",
      "rules": [
        {
          "alert": "AuthenticationFailureSpike",
          "expr": "rate(auth_failures_total[5m]) > 10",
          "for": "2m",
          "labels": {"severity": "high", "component": "security"},
          "annotations": {
            "summary": "Spike in authentication failures",
            "description": "{{ $value }} failed auth attempts per second - possible brute force attack"
          }
        },
        {
          "alert": "RateLimitViolations",
          "expr": "rate(rate_limit_exceeded_total[5m]) > 50",
          "for": "5m",
          "labels": {"severity": "warning", "component": "security"},
          "annotations": {
            "summary": "High rate of rate limit violations",
            "description": "{{ $value }} rate limit violations per second"
          }
        },
        {
          "alert": "SuspiciousActivityDetected",
          "expr": "security_events_total{severity='high'} > 0",
          "for": "1m",
          "labels": {"severity": "high", "component": "security"},
          "annotations": {
            "summary": "Suspicious security activity detected",
            "description": "{{ $value }} high-severity security events"
          }
        },
        {
          "alert": "SSLCertificateExpiringSoon",
          "expr": "(ssl_certificate_expiry_timestamp - time()) / 86400 < 30",
          "for": "1h",
          "labels": {"severity": "warning", "component": "security"},
          "annotations": {
            "summary": "SSL certificate expiring soon",
            "description": "Certificate expires in {{ $value }} days"
          }
        }
      ]
    },
    {
      "name": "ai-orchestrator-business",
      "interval": "5m",
      "rules": [
        {
          "alert": "TaskSuccessRateLow",
          "expr": "(sum(rate(tasks_completed_total{status='success'}[15m])) / sum(rate(tasks_completed_total[15m]))) < 0.95",
          "for": "15m",
          "labels": {"severity": "warning", "component": "business"},
          "annotations": {
            "summary": "Task success rate below target",
            "description": "Success rate is {{ $value }}% (target: 95%)"
          }
        },
        {
          "alert": "NoActiveAgents",
          "expr": "agent_active_count == 0",
          "for": "2m",
          "labels": {"severity": "critical", "component": "business"},
          "annotations": {
            "summary": "No active agents available",
            "description": "All agents are inactive or failed"
          }
        },
        {
          "alert": "HighCostAnomaly",
          "expr": "rate(resource_cost_total[1h]) > avg_over_time(rate(resource_cost_total[1h])[7d:1h]) * 1.5",
          "for": "1h",
          "labels": {"severity": "warning", "component": "cost"},
          "annotations": {
            "summary": "Unusually high resource costs",
            "description": "Cost is 50% above 7-day average"
          }
        }
      ]
    }
  ]
}
