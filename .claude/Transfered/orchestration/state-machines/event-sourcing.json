{
  "name": "Event Sourcing State Machine",
  "description": "State machine for event-driven coordination",
  "initialState": "ready",
  "states": [
    {"name": "ready", "description": "Ready to process events", "type": "initial"},
    {"name": "appending", "description": "Appending event to log", "type": "intermediate"},
    {"name": "processing_handlers", "description": "Processing event handlers", "type": "intermediate"},
    {"name": "updating_state", "description": "Updating current state", "type": "intermediate"},
    {"name": "snapshotting", "description": "Creating snapshot", "type": "intermediate"},
    {"name": "reconstructing", "description": "Reconstructing state from events", "type": "intermediate"},
    {"name": "time_traveling", "description": "Time-traveling to specific point", "type": "intermediate"},
    {"name": "event_appended", "description": "Event successfully appended", "type": "final"},
    {"name": "state_reconstructed", "description": "State successfully reconstructed", "type": "final"},
    {"name": "failed", "description": "Operation failed", "type": "final"}
  ],
  "transitions": [
    {"from": "ready", "to": "appending", "event": "APPEND_EVENT", "guard": "eventValid", "action": "createEvent"},
    {"from": "appending", "to": "processing_handlers", "event": "EVENT_APPENDED", "guard": "hasHandlers", "action": "invokeHandlers"},
    {"from": "appending", "to": "updating_state", "event": "EVENT_APPENDED", "guard": "!hasHandlers", "action": "skipHandlers"},
    {"from": "processing_handlers", "to": "updating_state", "event": "HANDLERS_COMPLETE", "guard": null, "action": "applyEventToState"},
    {"from": "updating_state", "to": "snapshotting", "event": "SNAPSHOT_INTERVAL", "guard": "shouldSnapshot", "action": "createSnapshot"},
    {"from": "updating_state", "to": "event_appended", "event": "STATE_UPDATED", "guard": "!shouldSnapshot", "action": "completeAppend"},
    {"from": "snapshotting", "to": "event_appended", "event": "SNAPSHOT_CREATED", "guard": null, "action": "completeAppend"},
    {"from": "ready", "to": "reconstructing", "event": "RECONSTRUCT_STATE", "guard": "hasReducer", "action": "loadSnapshot"},
    {"from": "reconstructing", "to": "state_reconstructed", "event": "RECONSTRUCTION_COMPLETE", "guard": null, "action": "returnState"},
    {"from": "ready", "to": "time_traveling", "event": "TIME_TRAVEL", "guard": "timeTravelEnabled", "action": "findTargetVersion"},
    {"from": "time_traveling", "to": "reconstructing", "event": "VERSION_FOUND", "guard": null, "action": "reconstructToVersion"},
    {"from": "appending", "to": "failed", "event": "APPEND_FAILED", "guard": null, "action": "recordError"},
    {"from": "reconstructing", "to": "failed", "event": "RECONSTRUCTION_FAILED", "guard": null, "action": "recordError"}
  ],
  "errorStates": ["failed"],
  "recoveryTransitions": [
    {"from": "failed", "to": "ready", "event": "RESET", "guard": null, "action": "clearError"}
  ]
}
