{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ai-orchestrator.com/schemas/memory-structure.json",
  "title": "Memory Structure Schema",
  "description": "Core data structures for the 5-tier hierarchical memory system",
  "definitions": {
    "SensoryMemoryItem": {
      "type": "object",
      "description": "Ultra-short term sensory buffer item (5s TTL)",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier",
          "pattern": "^sensory:"
        },
        "type": {
          "type": "string",
          "enum": ["visual", "auditory", "textual", "system", "user_input", "api_response"],
          "description": "Type of sensory input"
        },
        "data": {
          "description": "Raw sensory data"
        },
        "timestamp": {
          "type": "number",
          "description": "Creation timestamp in milliseconds",
          "minimum": 0
        },
        "intensity": {
          "type": "number",
          "description": "Signal strength (0-1)",
          "minimum": 0,
          "maximum": 1
        },
        "metadata": {
          "type": "object",
          "description": "Additional metadata"
        },
        "attentionScore": {
          "type": "number",
          "description": "Computed attention score (0-1)",
          "minimum": 0,
          "maximum": 1
        }
      },
      "required": ["id", "type", "data", "timestamp", "intensity", "attentionScore"],
      "additionalProperties": false
    },
    "WorkingMemoryItem": {
      "type": "object",
      "description": "Active context item (1h TTL, 7Â±2 capacity)",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier",
          "pattern": "^working:"
        },
        "type": {
          "type": "string",
          "enum": ["task_context", "active_goal", "recent_interaction", "cached_result", "attention_focus", "chunk"],
          "description": "Type of working memory item"
        },
        "data": {
          "description": "Item data (null if chunked)"
        },
        "timestamp": {
          "type": "number",
          "description": "Creation timestamp",
          "minimum": 0
        },
        "lastAccessed": {
          "type": "number",
          "description": "Last access timestamp",
          "minimum": 0
        },
        "accessCount": {
          "type": "number",
          "description": "Number of accesses",
          "minimum": 0
        },
        "priority": {
          "type": "number",
          "description": "Item priority (1-5)",
          "minimum": 1,
          "maximum": 5
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags for categorization"
        },
        "metadata": {
          "type": "object",
          "description": "Additional metadata"
        },
        "chunkIds": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Related chunk IDs if chunked"
        },
        "rehearsalCount": {
          "type": "number",
          "description": "Number of rehearsals",
          "minimum": 0
        }
      },
      "required": ["id", "type", "timestamp", "lastAccessed", "accessCount", "priority", "tags", "chunkIds", "rehearsalCount"],
      "additionalProperties": false
    },
    "EpisodicMemoryItem": {
      "type": "object",
      "description": "Long-term experience storage (Cosmos DB)",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier",
          "pattern": "^episode:"
        },
        "type": {
          "type": "string",
          "enum": ["conversation", "task_execution", "decision_point", "error_event", "user_interaction", "system_event", "learning_moment"],
          "description": "Type of episode"
        },
        "timestamp": {
          "type": "number",
          "description": "Event timestamp",
          "minimum": 0
        },
        "duration": {
          "type": "number",
          "description": "Duration in milliseconds",
          "minimum": 0
        },
        "context": {
          "type": "object",
          "description": "Contextual information"
        },
        "data": {
          "description": "Episode data (may be compressed)"
        },
        "participants": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Involved entities (users, agents)"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags for categorization"
        },
        "emotions": {
          "type": "object",
          "description": "Emotional valence"
        },
        "summary": {
          "type": "string",
          "description": "Compressed summary"
        },
        "relatedEpisodes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Related episode IDs"
        },
        "metadata": {
          "type": "object",
          "properties": {
            "compressed": {
              "type": "boolean"
            },
            "originalSize": {
              "type": "number"
            },
            "createdAt": {
              "type": "string",
              "format": "date-time"
            },
            "version": {
              "type": "string"
            }
          }
        }
      },
      "required": ["id", "type", "timestamp", "duration", "context", "data", "participants", "tags", "summary", "relatedEpisodes", "metadata"],
      "additionalProperties": false
    },
    "SemanticMemoryItem": {
      "type": "object",
      "description": "Long-term knowledge storage (Pinecone vectors)",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier",
          "pattern": "^knowledge:"
        },
        "type": {
          "type": "string",
          "enum": ["fact", "concept", "relationship", "rule", "pattern", "definition", "example"],
          "description": "Type of knowledge"
        },
        "content": {
          "type": "string",
          "description": "Text content"
        },
        "embedding": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "description": "Vector embedding (1536 dimensions for ada-002)",
          "minItems": 1536,
          "maxItems": 1536
        },
        "metadata": {
          "type": "object",
          "properties": {
            "tags": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "relatedConcepts": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "confidence": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "source": {
              "type": "string"
            },
            "timestamp": {
              "type": "number"
            },
            "createdAt": {
              "type": "string",
              "format": "date-time"
            }
          }
        }
      },
      "required": ["id", "type", "content", "embedding", "metadata"],
      "additionalProperties": false
    },
    "ProceduralMemoryItem": {
      "type": "object",
      "description": "Learned skills and patterns (Git versioned)",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier",
          "pattern": "^skill:"
        },
        "type": {
          "type": "string",
          "enum": ["code_pattern", "workflow", "automation", "template", "function", "algorithm", "heuristic"],
          "description": "Type of skill"
        },
        "name": {
          "type": "string",
          "description": "Skill name"
        },
        "description": {
          "type": "string",
          "description": "Description"
        },
        "code": {
          "type": "string",
          "description": "Executable code or pattern"
        },
        "metadata": {
          "type": "object",
          "description": "Additional metadata"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags"
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Required dependencies"
        },
        "performance": {
          "type": "object",
          "properties": {
            "averageDuration": {
              "type": "number",
              "minimum": 0
            },
            "minDuration": {
              "type": "number",
              "minimum": 0
            },
            "maxDuration": {
              "type": "number",
              "minimum": 0
            }
          },
          "required": ["averageDuration", "minDuration", "maxDuration"]
        },
        "usageCount": {
          "type": "number",
          "description": "Times executed",
          "minimum": 0
        },
        "successRate": {
          "type": "number",
          "description": "Success rate (0-1)",
          "minimum": 0,
          "maximum": 1
        },
        "version": {
          "type": "string",
          "description": "Git commit hash"
        },
        "timestamp": {
          "type": "number",
          "description": "Creation timestamp",
          "minimum": 0
        }
      },
      "required": ["id", "type", "name", "description", "code", "metadata", "tags", "dependencies", "performance", "usageCount", "successRate", "version", "timestamp"],
      "additionalProperties": false
    },
    "Chunk": {
      "type": "object",
      "description": "Data chunk for working memory",
      "properties": {
        "id": {
          "type": "string",
          "description": "Chunk identifier",
          "pattern": ":chunk:"
        },
        "parentId": {
          "type": "string",
          "description": "Parent item ID"
        },
        "data": {
          "description": "Chunk data"
        },
        "index": {
          "type": "number",
          "description": "Chunk index in sequence",
          "minimum": 0
        },
        "totalChunks": {
          "type": "number",
          "description": "Total chunks in parent",
          "minimum": 1
        }
      },
      "required": ["id", "parentId", "data", "index", "totalChunks"],
      "additionalProperties": false
    }
  },
  "type": "object",
  "properties": {
    "sensoryMemory": {
      "$ref": "#/definitions/SensoryMemoryItem"
    },
    "workingMemory": {
      "$ref": "#/definitions/WorkingMemoryItem"
    },
    "episodicMemory": {
      "$ref": "#/definitions/EpisodicMemoryItem"
    },
    "semanticMemory": {
      "$ref": "#/definitions/SemanticMemoryItem"
    },
    "proceduralMemory": {
      "$ref": "#/definitions/ProceduralMemoryItem"
    },
    "chunk": {
      "$ref": "#/definitions/Chunk"
    }
  }
}
